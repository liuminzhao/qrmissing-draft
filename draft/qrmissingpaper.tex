\documentclass[12pt]{article}
\title{Quantile Regression in the Presence of Monotone Missingness}
\date{\today}
\author{}
\usepackage{amsmath}
\usepackage[round]{natbib}
\usepackage[verbose,letterpaper,tmargin=1in,bmargin=.75in,lmargin=.75in,rmargin=1in]{geometry}
\usepackage{graphicx}
\usepackage{mathpazo}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage[colorlinks,linkcolor=red,anchorcolor=blue,citecolor=blue]{hyperref}
\usepackage{amsthm}
\usepackage{booktabs}
\newtheorem{thm}{Theorem}[section]
\newtheorem{deff}[thm]{Definition}
\newtheorem{rmk}[thm]{Remark}
\newtheorem{prf}[thm]{Proof}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{emp}[thm]{Example}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{pps}[thm]{Proposition}
\newcommand{\iid}{\stackrel{\text{i.i.d}}{\sim}}
\DeclareMathOperator{\pr}{p}
\DeclareMathOperator{\prob}{Pr}
\newcommand{\polya}{P\'{o}lya}
\newcommand{\yobs}{\bm y_{\text{obs}}}
\newcommand{\ymis}{\bm y_{\text{mis}}}
\usepackage{subfiles}

\def\biblio{\bibliographystyle{plainnat}\bibliography{qr-missing-reference}}

\begin{document}
\def\biblio{}
\maketitle

\begin{abstract}
\end{abstract}

\section{Introduction}

Quantile regression is used to study the relationship between a
response and covariates when one (or several) quantiles are of
interest as opposed to mean regression.  The dependence between upper
or lower quantiles of the response variable and the covariates often
vary differentially relative to that of the mean. How quantiles depend
on covariates is of interest in econometrics, educational studies,
biomedical studies, and environment studies \citep{yu2001,
  buchinsky1994,buchinsky1998,he1998, koenker1999,wei2006,yu2003}. A
comprehensive review of applications of quantile regression was
presented in \citet{koenker2005}.

Quantile regression is more robust to outliers than mean regression
and provides information about how covariates affect quantiles, which
offers a more complete description of the conditional distribution of
the response. Different effects of covariates can be assumed for
different quantiles.

The traditional frequentist approach was proposed by
\citet{koenker1978} for a single quantile with estimators derived by
minimizing a loss function. The popularity of this approach is due to
its computational efficiency, well-developed asymptotic properties,
and straightforward extensions to simultaneous quantile regression and
random effect models. However, asymptotic inference may not be
accurate for small sample sizes and the approach does not naturally
extend to missing data.

Bayesian approaches offer exact inference in small samples. Motivated
by the loss (check) function, \citet{yu2001} proposed an asymmetric
Laplace distribution for the error term, such that maximizing the
posterior distribution is equivalent to minimizing the check function.
Also semiparametric methods have been proposed for median
regression. \citet{walker1999} used a diffuse finite \polya{} Tree
prior for the error term. \citet{kottas2001} modeled the error by two
families of median zero distribution using a mixture Dirichlet process
priors, which is very useful for unimodal error
distributions. \citet{hanson2002} adopted mixture of \polya{} Tree
prior in median regression, which is more robust in terms of
multimodality and skewness. Other recent approaches include quantile
pyramid priors, mixture of Dirichlet process priors of multivariate
normal distributions and infinite mixture of Gaussian densities which
place quantile constraints on the residuals \citep{hjort2007,
  hjort2009, kottas2009,reich2010}.

The above methods focus on complete data.  There are a few articles
about quantile regression with missingness.  \citet{wei2012} proposed
a multiple imputation method for quantile regression model when there
are some covariates missing at random (MAR). They impute the missing
covariates by specifying its conditional density given observed
covariates and outcomes, which comes from the estimated conditional
quantile regression and specification of conditional density of
missing covariates given observed ones.  However, they put more focus
on the missing covariates rather than missing outcomes.
\citet{bottai2013} illustrated an imputation method using estimated
conditional quantiles of missing outcomes given observed data. Their
approach does not make distribution assumptions.  They assumed the
missing data mechanism (MDM) is ignorable. However, because his
imputing method does not depend on a fully conditional likelihood
parametric model, it may not converge to a coherent stationary
distribution model. In addition, their imputing method does not allow
non-ignorable missingness.

For missing not at random (MNAR), \citet{yuan2010} introduced a
Bayesian quantile regression approach for longitudinal data with
nonignorable missing data. They used random effects to explain the
within-subject correlation and applied a $l_2$ penalty in the
traditional quantile regression check function to shrink toward the
common population values. However, the quantile regression
coefficients are conditional on the random effects, which is not of
interest if we are looking into the marginal relationship. In
addition, they did not allow for sensitivity analysis which is
essential for proper analysis of incomplete data \citep{nas2010}.

Pattern mixture models were proposed to address missing data in
\citet{rubin1977}. Later mixture models are extended to handle
informative dropout in longitudinal data. For discrete dropout time
scenario, \citet{little1993, little1994} proposed a general method by
introducing a finite mixture of multivariate distribution for
longitudinal data. When there are many possible dropout time,
\citet{roy2003} proposed to group them by latent classes.

\citet{roy2008} extended \cite{roy2003} to generalized linear models
and proposed a pattern mixture model for data with nonignorable
dropout, borrowing ideas from \citet{heagerty1999}.  But their
approach only estimates the marginal covariate effects on the mean. We
will use related ideas for quantile regression models which allows
non-ignorable missingness, MNAR and sensitivity analysis.

The structure of this article is as follows. First, we introduce a
quantile regression method to address monotone nonignorable dropout
missingness in section \ref{sec:model}, including sensitivity analysis
and computational details.  We use simulation studies to evaluate the
performance of the model in section \ref{sec:simulation}. We apply our
approach to data from a recent clinical trial in section
\ref{sec:real}. Finally, discussion and conclusions are in section
\ref{sec:discussion}.

\section{Model}
\label{sec:model}

In this section, we first introduce some notation
, then describe our proposed quantile regression model in
section \ref{sec:settings}. We provide details on MAR and MNAR
and computation in sections \ref{sec:sa} and \ref{sec:computation}.

Under monotone dropout, without loss of generality, denote $S_i \in
\{1, 2, \ldots, J\}$ to be the follow up time, and $\bm Y_i = (Y_{i1},
Y_{i2}, \ldots, Y_{iJ})^{T}$ to be the response vector for subject
$i$, where $J$ is the maximum follow up time. We assume $Y_{i1}$ is
always observed. We are interested in the $\tau$-th marginal quantile
regression coefficients $\bm \gamma_j = (\gamma_{j0}, \gamma_{j2},
\ldots, \gamma_{jp})^T$,
\begin{equation}
  \label{eq:quantile}
  \prob (Y_{ij} \leq \bm x_i^{T} \bm \gamma_j ) = \tau, \text{ for } j = 1, \ldots, J,
\end{equation}
where $\bm x_i$ is a $p \times 1$ vector of covariates for subject $i$.

Let
\begin{align*}
  \pr_k(Y) &= \pr (Y | S = k), \\
  \pr_{\geq k} (Y) & = \pr (Y | S \geq k)
\end{align*}
be the densities of response $\bm Y$ given follow-up time $S=k$ and $S
\geq k$. And $\prob_k$ be the corresponding probability given $S = k$.

\subsection{Mixture Model Specification}
\label{sec:settings}
We adopt a pattern mixture model to jointly model the response and
missingness \citep{little1994, dh2008}. Mixture models factor the
joint distribution of response and missingness as
\begin{displaymath}
  \pr (\bm y, \bm S, |\bm x, \bm \omega) = \pr (\bm y|\bm S, \bm x, \bm \omega) \pr (\bm S | \bm x, \bm \omega).
\end{displaymath}
Thus the full-data response follows the distribution is given by
\begin{displaymath}
  \pr (\bm y | \bm x, \bm \omega) = \sum_{S \in \mathcal{S}} \pr(\bm y| \bm S, \bm x, \bm \theta) \pr (\bm S | \bm x, \bm \phi),
\end{displaymath}
where $\mathcal{S}$ is the sample space for dropout time $S$ and the
parameter vector $\bm \omega$ is partitioned as $(\bm \theta, \bm
\phi)$.

Furthermore, the conditional distribution of response within patterns
can be decomposed as
\begin{displaymath} \pr (\yobs, \ymis | \bm S, \bm \theta) = \pr
  (\ymis|\yobs, \bm S, \bm \theta_E) \pr (\yobs | \bm S, \bm
  \theta_{y, O}, \bm \phi),
\end{displaymath}
where $\bm \theta_E$ indexes the parameters in an extrapolation
distribution, $\bm \theta_{y, O}, \bm \phi$ indexes parameters in
distributions of observed data.

We assume models within pattern to be multivariate normal
distributions and specify a sequential model parametrization. Let the
subscript $i$ stand for subject $i$. Specify the conditional
distribution as:
\begin{equation}
  \label{eq:model}
  \left.  \begin{aligned}
      & \pr_k(y_{i1}) = \textrm{N} (\Delta_{i1} + \bm x_{i1}^T \bm \beta_1^{(k)},
      \exp (\bm x_{i1}^T \bm \alpha_1^{(k)} ) ), k = 1, \ldots, J,\\
      &\pr_k(y_{ij}|\bm y_{ij^{-}}) =
      \begin{cases}
        \textrm{N} \big (\Delta_{ij} + \bm x_{ij}^T \bm h_{j}^{(k)} +
        \bm y_{ij^{-}}^T \bm \beta_{y,j-1}^{(k)},
        \exp (\bm x_{ij}^T \bm \alpha_j^{(k)} ) \big), & k < j ;  \\
        \textrm{N} \big (\Delta_{ij} + \bm y_{ij^{-}}^T \bm
        \beta_{y,j-1}^{(\geq j)},
        \exp (\bm x_{ij}^T \bm \alpha_j^{(\geq j)} ) \big), & k \geq j ;  \\
      \end{cases}, \text{ for } 2 \leq j \leq J,  \\
      &S_{ij} = k| \bm x_{ij} \sim \textrm{Multinomial}(1, \bm \pi),
    \end{aligned} \right\}
\end{equation}
where $\bm y_{ij^{-}} = (y_{i1}, \ldots, y_{i(j-1)})^T, \bm \pi =
(\pi_1, \ldots, \pi_J)$,$\bm h_j^{(k)} = (h_{j1}^{(k)}, \ldots,
h_{jp}^{(k)})$, $\bm x_j$ is a $p \times 1$ covariate vector, $\bm
\beta_{y, j-1}^{(k)} = \big(\beta_{y_1, j-1}^{(k)}, \ldots,
\beta_{y_{j-1}, j-1}^{(k)} \big)^T$ and $\bm \alpha_j^{(k)}$ is a $p
\times 1$ vector controlling heterogeneity of conditional variance of
response component $j$. We specify the model as in (\ref{eq:model}) to
, have multivariate normal distribution within patterns and to allow
MAR to exist \citep{wang2011}. More details are presented in section
\ref{sec:sa}.

In (\ref{eq:model}), $\Delta_{ij}$ are functions of $\tau, \bm x_{ij},
\bm \alpha_j, \bm \gamma_j$ and other parameters and are determined by
the marginal quantile regressions,
\begin{align}
  \label{eq:deltaeqn1}
  \tau = \prob (Y_{ij} \leq \bm x_{ij}^T \bm \gamma_j ) = \sum_{k=1}^J
  \pi_k\prob_k (Y_{ij} \leq \bm x_{ij}^T \bm \gamma_j ),
\end{align}
for $j = 1$ and
\begin{align}\label{eq:deltaeqn2}
  \tau &= \prob (Y_{ij} \leq \bm x_{ij}^{T} \bm \gamma_j ) =
  \sum_{k=1}^J
  \pi_k\prob_k (Y_{ij} \leq \bm x_{ij}^{T} \bm \gamma_j ) \\
  & = \sum_{k=1}^J \pi_k \int\cdots \int \prob_k (Y_{ij} \leq \bm
  x_{ij}^{T} \bm \gamma_j |y_{i1},\ldots,
  y_{i(j-1)}) \pr_k (y_{i(j-1)}| y_{i1}, \ldots, y_{i(j-2)})  \nonumber \\
  & \quad \cdots \pr_k (y_{i2}| y_{i1}) \pr_k(y_{i1})
  dy_{i(j-1)}\cdots dy_{i1}. \nonumber
\end{align}
for $j = 2, \ldots, J$. Computational details will be given in section
\ref{sec:computation}.

The idea is to model the marginal quantile regressions directly, then
to embed them in the likelihood through restrictions in the mixture
model. The mixture model and heterogeneity of variance between
subjects in (\ref{eq:model}) allows the marginal quantile regression
coefficients to differ by quantiles. Otherwise, the quantile lines
would be parallel to each other.

For identifiability of the observed data distribution, we apply the
following restrictions,
\begin{align*}
  & \sum_{k=1}^J \beta_{l1}^{(k)} = 0, l = 1,\ldots, p,
\end{align*}
where $\bm \beta_1^{(k)} = (\beta_{11}^{(k)}, \ldots,
\beta_{p1}^{(k)})^{T}$. Further details on these restrictions can be
found in Appendix \ref{sec:iden}.

\subsection{Missing Data Mechanism and Sensitivity Analysis}
\label{sec:sa}

In general, mixture models are not identified due to insufficient
information provided by observed data. Specific forms of missingness
are needed to induce constraints to identify the distributions for
incomplete patterns, in particular, the extrapolation distribution. In
this section, we explore ways to embed the missingness mechanism and
sensitivity parameters in mixture models for our setting.

In the mixture model in (\ref{eq:model}), MAR holds \citep{molen1998,
  wang2011} if and only if, for each $j \geq 2$ and $k < j$:
\begin{equation}
  \label{eq:molen}
  \pr_k(y_j|y_1, \ldots, y_{j-1}) = \pr_{\geq j}(y_j|y_1, \ldots, y_{j-1}).
\end{equation}
When $2 \leq j \leq J$ and $k < j$, $Y_j$ is not observed, thus $\bm
h_j^{(k)}$ and $\bm \alpha_j^{(k)}$, $ \bm \beta_{y, j-1}^{(k)} =
\big(\beta_{y_1,j}^{(k)}, \ldots, \beta_{y_{j-1},j-1}^{(k)} \big)^T $
can not be identified from the observed data. Denote
\begin{align*}
  \bm \alpha_j^{(k)} &= \bm \alpha_j^{(\geq j)} + \bm \delta_{j}^{(k)}, \\
  \bm \beta_{y, j-1}^{(k)} &= \bm \beta_{y, j-1}^{(\geq j)} + \bm
  \eta_{j-1}^{(k)},
\end{align*}
where $\bm \delta_j^{(k)} = \big( \delta_{1j}^{(k)}, \ldots,
\delta_{pj}^{(k)} \big)$ and $\bm \eta_{j-1}^{(k)} = \big(
\eta_{y_1,j-1}^{(k)}, \ldots, \eta_{y_{j-1}, j-1}^{(k)} \big)$ for $k
< j$. Then $\bm \xi_s = ( \bm h_j^{(k)}, \bm \eta_{j-1}^{(k)}, \bm
\delta_j^{(k)})$ is a set of sensitivity parameters \citep{dh2008},
where $k < j, 2 \leq j \leq J $.

When $\bm \xi_s = \bm \xi_{s0} = \bm 0$, MAR holds. If $\bm \xi_s$ is
fixed at $\bm \xi_s \neq \bm \xi_{s0}$, the missingness mechanism is
MNAR.

For fully Bayesian inference, we can put independent priors on $(\bm
\xi_s, \bm \xi_m)$ as :
\begin{displaymath}
  p(\bm \xi_s, \bm \xi_m) = p(\bm \xi_s) p(\bm \xi_m),
\end{displaymath}
where $\bm \xi_m = \big(\bm \gamma_j, \bm \beta_{y, j-1}^{(\geq j)},
\bm \alpha_j^{(\geq j)}, \bm \pi \big)$.

If we assume MAR with no uncertainty, the prior of $\bm \xi_s$ is
$\pr(\bm \xi_s = \bm 0) \equiv 1$. Sensitivity analysis can be
executed by putting point mass priors on $\bm \xi_s$ to examine the
effect of priors on the posterior inference about quantile regression
coefficients $\bm \gamma_{ij}^{\tau}$. For example, if MAR is assumed
with uncertainty, priors can be assigned as $\textrm{E}(\bm \xi_s) =
\bm \xi_{s0} = \bm 0$ with $\textrm{Var}(\bm \xi_s) \neq \bm 0$. If we
assume MNAR with no uncertainty, we can put priors satisfying
$\textrm{E}(\bm \xi_s) = \Delta_{\xi}$, where $\Delta_{\xi} \neq \bm
0$ and $\textrm{Var}(\bm \xi_s) = \bm 0$. If MNAR is assumed with
uncertainty, then priors could be $\textrm{E}(\bm \xi_s) =
\Delta_{\xi}$, where $\Delta_{\xi} \neq \bm 0 $ and $\textrm{Var}(\bm
\xi_s) \neq \bm 0$.

In general, each pattern $S = k$ has its own set of sensitivity
parameters $\bm \xi_s^{(k)}$. However, to keep the number of
sensitivity parameters at a manageable level \citep{dh2008}, without
loss of generality, we assume independence of $\bm \xi_s$ does not
depend on pattern.

\subsection{Computation}
\label{sec:computation}

In section \ref{sec:deltacal}, we provide details on calculating
$\Delta_{ij}$ in (\ref{eq:model}) for $j = 1, \ldots, J$. Then we show
how to obtain maximum likelihood estimates using an adaptive gradient
descent algorithm in section \ref{sec:mle}. Finally, we present a
Monte Carlo Markov Chain (MCMC) sampling algorithm for Bayesian
inference in section \ref{sec:bayesian}.

\subsubsection{Calculation of $\Delta$ }
\label{sec:deltacal}
From equation (\ref{eq:deltaeqn1}) and (\ref{eq:deltaeqn2}),
$\Delta_{ij}$ depends on subject-specific covariates $\bm x_i$, thus
$\Delta_{ij}$ needs to be calculated for each subject. We now
illustrate how to calculate $\Delta_{ij}$ given all the other
parameters $\bm \xi = (\bm \xi_m, \xi_s)$.

\begin{itemize}
\item \textbf{$\Delta_{i1}: $} Expand equation (\ref{eq:deltaeqn1}):
  \begin{align*}
    \tau = \sum_{k = 1}^J \pi_k \Phi \left( \frac{\bm x_{i1}^T \bm
        \gamma_1 - \Delta_{i1} - \bm x_{i1}^T\bm \beta_1^{(k)}}{\exp
        \big( \bm x_{i1}^T \bm \alpha_1^{(k)} \big)} \right),
  \end{align*}
  where $\Phi$ is the standard normal CDF. Because the above equation
  is continuous and monotone in $\Delta_{i1}$, it can be solved by a
  standard numerical root-finding method (e.g. bisection method) with
  minimal difficulty.

\item \textbf{$\Delta_{ij}, 2\leq j \leq J: $}

  First we introduce a lemma:
  \begin{lem}\label{sec:lemma}
    An integral of a normal CDF with mean $b$ and standard deviation
    $a$ over another normal distribution with mean $\mu$ and standard
    deviation $\sigma$ can be simplified to a closed form in terms of
    normal CDF:
    \begin{equation}
      \label{eq:lem}
      \int \Phi \left( \frac{x-b}{a} \right) d\Phi(x; \mu, \sigma)  =
      \begin{cases}
        1- \Phi \left( \frac{b-\mu}{\sigma} \big / \sqrt{\frac{a^2}{\sigma^2}+1} \right) & a > 0, \\
        \Phi \left( \frac{b-\mu}{\sigma} \big /
          \sqrt{\frac{a^2}{\sigma^2}+1} \right) & a < 0,
      \end{cases}
    \end{equation}
    where $\Phi(x; \mu, \sigma)$ stands for a CDF of normal
    distribution with mean $\mu$ and standard deviation $\sigma$.
  \end{lem}
  Proof of \ref{sec:lemma} is in Appendix \ref{sec:proof}.

  To solve equation (\ref{eq:deltaeqn2}), we propose a recursive
  approach. For the first multiple integral in equation
  (\ref{eq:deltaeqn2}), apply lemma \ref{sec:lemma} once to obtain:
  \begin{align*}
    \prob (Y_j \leq \bm x^T \bm \gamma_j | S = 1) & = \int\dots\int
    \prob (Y_j \leq \bm x^T\bm \gamma_j | S=1, \bm x, Y_{j-1}, \ldots, Y_1)\\
    & \quad  dF(Y_{j-1}|S=1, Y_{j-2}, \ldots, Y_1) \cdots dF(Y_2|S=1, Y_1) d F (Y_1 | S = 1), \\
    & = \int\dots\int
    \Phi \left( \frac{\bm x^T \bm \gamma_j - \mu_{j|1, \ldots, j-1}(y_{j-1})}{\sigma_{j|1, \ldots, j-1}} \right) \\
    & \quad dF(Y_{j-1}|S=1, Y_{j-2}, \ldots, Y_1) \cdots dF(Y_2|S=1, Y_1) d F (Y_1 | S = 1), \\
    & = \int\dots\int \Phi \left( \frac{y_{j-2} - b^{*}}{a^{*}}
    \right) dF(Y_{j-2}|S=1, Y_{j-3}, \ldots, Y_1) \cdots d F (Y_1 | S
    = 1).
  \end{align*}

  Then, by recursively applying lemma \ref{sec:lemma} $(j-1)$ times,
  each multiple integral in equation (\ref{eq:deltaeqn2}) can be
  simplified to single normal CDF. Thus it can be solved for
  $\Delta_{ij}$ using standard numerical root-finding method as for $j
  = 1$.

\end{itemize}

\subsubsection{Maximum Likelihood Estimation}
\label{sec:mle}

The observed data likelihood for an individual $\bm y_i$ with
follow-up time $S = k$ is
\begin{align} \label{eq:ll} L_i(\bm \xi| \bm y_i, S_{i} = k) & =
  \pi_k\pr_k (y_k | y_1, \ldots, y_{k-1})
  \pr_k (y_{k-1}|y_1, \ldots, y_{k-2}) \cdots \pr_{k} (y_1), \\
  & = \pi_k \pr_{\geq k} (y_k | y_1, \ldots, y_{k-1}) \pr_{\geq k-1}
  (y_{k-1}|y_1, \ldots, y_{k-2}) \cdots \pr_{k} (y_1), \nonumber
\end{align}
where $\bm y_i = (y_1, \ldots, y_k)$.

We use an adaptive gradient descent algorithm to compute the maximum
likelihood estimates \citep{ried1993}. Denote $J(\bm \xi) = - \log L =
- \log \sum_{i = 1}^n L_i$.  Then maximizing the likelihood is
equivalent to minimize the target function $J(\bm \xi)$. Under an MAR
assumption, we fix $\bm \xi_s = \bm 0$, while under MNAR assumption,
$\bm \xi_s $ can be chosen as desired.

During each step of the algorithm, $\Delta_{ij}$ has to be calculated
for each subject and at each time, as well as partial derivatives for
each parameter.

As an example of the speed of the algorithm, for 500 bivariate
outcomes and 4 covariates, it takes about 11 seconds for 70 iterations
to get convergence using R version 2.15.3 (2013-03-01) \citep{R} and
platform: x86\_64-apple-darwin9.8.0/x86\_64 (64-bit). Main parts of
the algorithm are coded in Fortran such as calculation of numerical
derivatives and log-likelihood to quicken computation.

Further details about the maximization algorithm are presented in
Appendix \ref{sec:agda}.

We use the bootstrap \citep{efron1979,efron1993,divison1997} to
construct confidence interval and make inferences.  For quantile
regression models, we treat the covariates as random among samples,
thus a random-x resampling or case resampling approach is adopted to
bootstrap. The bootstrap percentile interval is used to form
confidence intervals.

A simple goodness-of-fit test can be done by looking into the normal
QQ plot of the fitted residuals from the model. The visual test can
help to diagnostic if the parametric assumption of normal distribution
is suitable for model. We will illustrate them in section
\ref{sec:simulation} and \ref{sec:real}.

\subsubsection{Bayesian Framework}
\label{sec:bayesian}

For a Bayesian inference, we specify priors on the parameters $\bm
\xi$ and use a block Gibbs sampling method to draw samples from the
posterior distribution. Denote all the parameters (including
sensitivity parameters) to sample as :
\begin{displaymath}
  \bm \xi_m = \left\{ \bm \gamma_1, \bm \gamma_2, \ldots, \gamma_J,
    \bm \beta_{y,j-1}^{(\geq j)}, \bm \alpha_j^{(\geq j)} \right\}
  \text{ for } j = 1, \ldots, J ,
  \bm \xi_s = \left\{ \bm h_j^{(k)}, \bm \eta_{j-1}^{(k)}, \bm \delta_j^{(k)}
  \right\}
  \text{ for } k = 1, \ldots, j; 2 \leq j \leq J.
\end{displaymath}
Comma separated parameters are marked to sample as a block.  Updates
of $\bm \xi_m$ require Metropolis-Hasting algorithm, while $\bm \xi_s$
samples are drawn directly from priors as desired for missingness
mechanism assumptions.

As mentioned in section \ref{sec:sa}, MAR or MNAR assumptions are
implemented via specific priors. For example, if MAR is assumed with
no uncertainty, then $ \bm \xi _s= \bm 0$ with probability 1. Details
for updating parameters are:

\begin{itemize}
\item $\bm \gamma_{1} $: Use Metropolis-Hasting algorithm.
  \begin{enumerate}
  \item Draw ($\bm \gamma_{1}^c$) candidates from candidate
    distribution;
  \item Based on the new candidate parameter $\bm \xi^c$, calculate
    candidate $\Delta_{i1}^c$ for each subject $i$ as we described in
    section \ref{sec:deltacal}. If $S > 1$ for subject $i$, update
    candidate $\Delta_{ij}^c, j \geq 2$ as well since $\Delta_{ij}, j
    \geq 2$ depends on $\Delta_{i1}$. (For $S = 1$, we only need to
    update $\Delta_{i1}^c$);
  \item Plug in $\Delta_{i1}^c$ or ($\Delta_{i1}^c, \Delta_{ij}^c, j
    \geq 2$) in likelihood (\ref{eq:ll}) to get candidate likelihood;
  \item Compute Metropolis-Hasting ratio, and accept the candidate
    value or keep the previous value.
  \end{enumerate}
\item For the rest of the identifiable parameters, algorithms for
  updating the samples are all similar to $\bm \gamma_j$.
\item For sensitivity parameters, because we do not get any
  information from the data, we sample them from priors, which are
  specified based on assumptions about the missingness.
\end{itemize}

\section{Simulation Study}
\label{sec:simulation}
In this section, we compared the performance of our proposed model in
section \ref{sec:settings} with the \textit{rq} function in
\textit{quantreg} R package \citep{quantreg} and Bottai's algorithm
\citep{bottai2013} (noted as \textit{BZ}). The \textit{rq} function
minimizes the loss (check) function $\sum_{i=1}^n \rho_{\tau} (y_i -
\bm x_i^T \bm \beta)$ in terms of $\bm \beta$, where the loss function
$\rho_{\tau} (u) = u(\tau - I(u < 0))$ and does not make any
distributional assumptions. \citet{bottai2013} impute missing outcomes
using the estimated conditional quantiles of missing outcomes given
observed data. Their approach does not make distributional assumptions
similar to \textit{rq}.  Their imputation assume ignorable missing
data.

We considered three scenarios corresponding to both MAR and MNAR
assumptions for a bivariate response.  In the first scenario, $Y_2$
were missing at random and we used MAR assumption in our algorithm. In
the last two scenarios, $Y_2$ were missing not at random. However, in
the second scenario, we misspecified the MDM for our algorithm and
still assumed MAR, while in the third scenario, we used the correct
MDM.  For each scenario, we prepared three error distributions:
normal, student t distribution with 3 degree of freedom and Laplace
distribution. For each error model, we simulated 1000 data sets. For
each set there are 200 bivariate observations $\bm Y_i = (Y_{i1},
Y_{i2})$ for $i = 1, \ldots, 200$. $Y_{i1}$ were always observed,
while some of $Y_{i2}$ were missing. A single covariate $x$ was
sampled from Uniform(0,2). The three models for the full data response
$\bm Y_i$ were:
\begin{align*}
  Y_{i1} | R = 1 & \sim 2 + x_i + (1 + 0.5x_i) \epsilon_{i1} , \\
  Y_{i1}| R = 0 & \sim  -2 - x_i + (1 + 0.5x_i) \epsilon_{i1} , \\
  Y_{i2}| R = 1, y_{i1}&\sim 1 - x_i - 1/2y_{i1} + (1 + 0.5x_i)
  \epsilon_{i2},
\end{align*}
where $\epsilon_{i1}, \epsilon_{i2} \iid \textrm{N}(0, 1)$ or $t_3$
within each scenario. And for $\text{LP}(\text{rate} = 1)$
distribution, the model is:
\begin{align*}
  Y_{i1} | R = 1 & \sim 4 + 2x_i + (1 + 0.5x_i) \epsilon_{i1} , \\
  Y_{i1}| R = 0 & \sim  -4 - 2x_i + (1 + 0.5x_i) \epsilon_{i1} , \\
  Y_{i2}| R = 1, y_{i1}&\sim 1 - x_i - 1/2y_{i1} + (1 + 0.5x_i)
  \epsilon_{i2},
\end{align*}
where $\epsilon_{i1}, \epsilon_{i2} \iid \text{LP}(\text{rate} = 1)$.

For all cases, $\prob (R = 1) = 0.5$.  When $R = 0$, $Y_{i2}$ is not
observed, so $\pr(Y_{i2}| R = 0, y_{i1})$ is not identifiable from
observed data.

In the first scenario, $Y_2$ is missing at random, thus $\pr(Y_{i2} |
R = 0, y_{i1}) = \pr(Y_{i2}|R = 1, y_{i1}) $. In the last two
scenarios, $Y_2$ are missing not at random. We assume $Y_{i2}| R = 0,
y_{i1} \sim 2 - x_i - 1/2y_{i1} + (1 + 0.5x_i)
\epsilon_{i2}$. Therefore, there is a shift of 1 in the intercept
between $\pr(Y_2|R = 1, Y_1)$ and $\pr(Y_2|R = 0, Y_1)$.

Under an MAR assumption, the sensitivity parameter $\bm \xi_s$ is
fixed at $(0,0,0,0,0)$ as discussed in section \ref{sec:sa}. For
\textit{rq} function from \textit{quantreg} R package, because only
$Y_{i2}|R = 1$ is observed, the quantile regression for $Y_{i2}$ can
only be fit from the information of $Y_{i2}|R = 1$ vs $x$.

Under true MNAR assumption, we still used the same $\bm \xi_s = \bm 0$
in scenario 2, mis-specifying the MDM. But we fixed $\bm \xi_s$ at the
true value $(1, 0, 0, 0, 0)$, assuming there was an intercept shift
between distribution of $Y_{i2}|Y_{i1}, R = 1$ and $Y_{i2}|Y_{i1}$, $R
= 0$ in scenario 3.

For each dataset, we fit quantile regression for quantiles $\tau =$
0.1, 0.3, 0.5, 0.7, 0.9.

Parameter estimates were evaluated by mean squared error (MSE),
\begin{equation*}
  \text{MSE} (\gamma_{ij}) = \frac{1}{1000} \sum_{k = 1}^{1000}
  \left( \hat{\gamma}_{ij}^{(k)}  - \gamma_{ij}\right)^2,
\end{equation*}
where $\gamma_{ij}$ is the true value for quantile regression
coefficient, $\hat{\gamma}_{ij}^{(k)}$ is the maximum likelihood
estimates in $k$-th simulated dataset ($(\gamma_{01}, \gamma_{11})$
for $Y_{i1}$, $(\gamma_{02}, \gamma_{12})$ for $Y_{i2}$).

Table \ref{tab:simh2}, \ref{tab:sim2} and \ref{tab:sim3} present the
MSE for coefficients estimates of quantile 0.1, 0.3, 0.5, 0.7, 0.9
under each scenario.  Simulation results show estimates from our
algorithm and Bottai's approach are closer to the true value for all
quantiles from 0.1 to 0.9.  In each scenario, our proposed method and
Bottai's have smaller MSE than \textit{rq} function in all cases for
normal error. And no matter if we mis-specified or used correct
sensitivity parameters, our approach has smaller MSE than \textit{BZ}.
As to the heavier tail distributions, $t_3$ and Laplace distribution,
our approach shows better performance in middle quantiles and lose to
\textit{rq} for extreme quantiles for observed data
$Y_1$. Nevertheless, our algorithm provides larger gains over
\textit{rq} function for each marginal quantile for the second
component $Y_2$, which are missing for some observations.  No matter
what missing data mechanism (MAR or MNAR), what assumption we use in
our approach ( misspecification or correct specified), our method
shows advantages over \textit{rq} function, especially for $Y_2$,
because \textit{quantreg} does not consider the missingness
mechanism. The difference in MSE becomes larger for the upper
quantiles because $Y_2 |R = 0$ tends to be larger than $Y_2 | R = 1$;
therefore, the \textit{rq} method using only the observed $Y_2$ yields
larger bias for upper quantiles.  Bottai's approach, however, shows
great advantage over \textit{rq} function for missing data because its
imputing method for missing responses.  It also has smaller MSE than
ours on extreme quantiles regression when distribution has heavy
tail. However, our approach has advantages on middle quantiles (30\% -
70\%) for marginal inference on missing responses regardless using
mis-specification or correct sensitivity parameters.

We also proposed a simple goodness of fit tool to check our parametric
model on model fit. We used the QQ plot on fitted residuals in model
(\ref{eq:model}) to check the normality assumption on the error
term. One sample goodness of fit diagnostic from the simulation {\bf
  (need ref? or see supplemental material?)} shows that when our error
assumption is correct (normal), the QQ plot reflects the fitted
residuals follow exact normal distribution. However, when we
misspecified the error distribution, the proposed diagnostic method
did suggest heavier tail error than normal, and this also explains why
our approach has some disadvantages on the extreme quantiles
regression when error is not normal.

\begin{table}[ht]
  \renewcommand{\arraystretch}{1.3}
  \centering
  \caption{Scenario 1: MSE for coefficients estimates of quantiles
    0.1, 0.3, 0.5, 0.7, 0.9 under MAR assumptions. $(\gamma_{01}, \gamma_{11})$
    are quantile regression coefficients for $Y_{i1}$, and $(\gamma_{02}, \gamma_{12})$
    are ones for $Y_{i2}$. MM stands for our proposed method, and RQ stands for the 'rq'
    function in R package 'quantreg'.}\label{tab:simh2}
  \vspace{10pt}
  \tabcolsep = 0.11cm
  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MAR Normal} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 0.03 & 0.04 & 0.04 & 0.03 & 0.06 & 0.06 & 0.06 & 0.51 & 0.51 & 0.03 & 0.05 & 0.05 & 0.03 & 0.04 & 0.04 \\
    $\gamma_{11}$ & 0.03 & 0.05 & 0.05 & 0.03 & 0.06 & 0.06 & 0.10 & 0.60 & 0.60 & 0.03 & 0.06 & 0.06 & 0.03 & 0.05 & 0.05 \\
    $\gamma_{02}$ & 0.03 & 0.27 & 0.05 & 0.03 & 0.57 & 0.05 & 0.04 & 1.04 & 0.07 & 0.06 & 1.67 & 0.09 & 0.10 & 2.41 & 0.13 \\
    $\gamma_{12}$ & 0.03 & 0.12 & 0.06 & 0.03 & 0.16 & 0.05 & 0.03 & 0.28 & 0.06 & 0.03 & 0.43 & 0.06 & 0.05 & 0.63 & 0.07 \\
    \bottomrule
  \end{tabular}

  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{ 15}{c}{MAR $T_3$} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$  & 0.14 & 0.09 & 0.09 & 0.10 & 0.06 & 0.06 & 0.12 & 0.40 & 0.40 & 0.09 & 0.06 & 0.06 & 0.11 & 0.09 & 0.09 \\
    $\gamma_{11}$  & 0.18 & 0.09 & 0.09 & 0.06 & 0.07 & 0.07 & 0.13 & 0.45 & 0.45 & 0.06 & 0.07 & 0.07 & 0.22 & 0.09 & 0.09 \\
    $\gamma_{02}$  & 0.27 & 0.42 & 0.10 & 0.09 & 0.45 & 0.05 & 0.11 & 1.03 & 0.09 & 0.18 & 1.86 & 0.13 & 0.41 & 2.33 & 0.28 \\
    $\gamma_{12}$  & 0.18 & 0.25 & 0.10 & 0.07 & 0.15 & 0.05 & 0.07 & 0.28 & 0.08 & 0.11 & 0.49 & 0.08 & 0.24 & 0.69 & 0.16 \\
    \bottomrule
  \end{tabular}

  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \hline
    & \multicolumn{15}{c}{MAR Laplace } \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 1.13 & 1.23 & 1.23 & 0.71 & 0.21 & 0.21 & 0.40 & 1.92 & 1.92 & 0.88 & 0.22 & 0.22 & 0.91 & 1.18 & 1.18 \\
    $\gamma_{11}$ & 1.63 & 0.56 & 0.56 & 0.19 & 0.25 & 0.25 & 0.37 & 2.09 & 2.09 & 0.19 & 0.21 & 0.21 & 2.07 & 0.59 & 0.59 \\
    $\gamma_{02}$ & 2.58 & 5.66 & 1.62 & 0.18 & 1.63 & 0.15 & 0.24 & 4.03 & 0.37 & 0.34 & 7.80 & 0.40 & 1.69 & 3.37 & 2.51 \\
    $\gamma_{12}$ & 0.94 & 1.81 & 0.67 & 0.18 & 0.51 & 0.16 & 0.21 & 1.07 & 0.38 & 0.24 & 2.12 & 0.28 & 1.07 & 1.47 & 0.88 \\
    \hline
  \end{tabular}

  The Laplace distribution in each scenario used the different sampling model.

\end{table}


\begin{table}[h]
  \renewcommand{\arraystretch}{1.3}
  \centering
  \caption{Scenario 2: MSE for coefficients estimates of quantiles
    0.1, 0.3, 0.5, 0.7, 0.9 under MNAR scenario. In this scenario, we adopted MAR assumption
    for our approach and thus misspecified the MDM. $(\gamma_{01}, \gamma_{11})$
    are quantile regression coefficients for $Y_{i1}$, and $(\gamma_{02}, \gamma_{12})$
    are ones for $Y_{i2}$. MM stands for our proposed method, and RQ stands for the 'rq'
    function in R package 'quantreg'.} \label{tab:sim2}
  \vspace{10pt}
  \tabcolsep = 0.11cm
  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR Normal} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 0.04 & 0.06 & 0.06 & 0.03 & 0.07 & 0.07 & 0.08 & 0.57 & 0.57 & 0.03 & 0.07 & 0.07 & 0.03 & 0.05 & 0.05 \\
    $\gamma_{11}$ & 0.04 & 0.06 & 0.06 & 0.03 & 0.07 & 0.07 & 0.11 & 0.63 & 0.63 & 0.03 & 0.08 & 0.08 & 0.04 & 0.06 & 0.06 \\
    $\gamma_{02}$ & 0.04 & 0.34 & 0.07 & 0.05 & 0.79 & 0.08 & 0.30 & 2.30 & 0.32 & 0.89 & 4.64 & 0.83 & 1.29 & 6.38 & 1.09 \\
    $\gamma_{12}$ & 0.05 & 0.16 & 0.08 & 0.03 & 0.21 & 0.06 & 0.04 & 0.30 & 0.07 & 0.04 & 0.44 & 0.08 & 0.07 & 0.69 & 0.10 \\
    \bottomrule
  \end{tabular}

  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR $T_3$} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 0.19 & 0.11 & 0.11 & 0.13 & 0.09 & 0.09 & 0.16 & 0.54 & 0.54 & 0.11 & 0.08 & 0.08 & 0.22 & 0.11 & 0.11 \\
    $\gamma_{11}$ & 0.26 & 0.11 & 0.11 & 0.08 & 0.09 & 0.09 & 0.17 & 0.60 & 0.60 & 0.07 & 0.09 & 0.09 & 0.32 & 0.11 & 0.11 \\
    $\gamma_{02}$ & 0.45 & 0.59 & 0.14 & 0.17 & 0.66 & 0.09 & 0.41 & 2.31 & 0.41 & 0.90 & 5.02 & 0.95 & 0.92 & 5.89 & 1.01 \\
    $\gamma_{12}$ & 0.28 & 0.31 & 0.12 & 0.10 & 0.18 & 0.07 & 0.08 & 0.30 & 0.09 & 0.14 & 0.50 & 0.09 & 0.32 & 0.79 & 0.20 \\
    \bottomrule
  \end{tabular}

  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR Laplace \footnote{*}} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 1.32 & 1.42 & 1.42 & 0.82 & 0.29 & 0.29 & 0.48 & 2.15 & 2.15 & 0.93 & 0.28 & 0.28 & 1.00 & 1.35 & 1.35  \\
    $\gamma_{11}$ & 1.73 & 0.67 & 0.67 & 0.21 & 0.27 & 0.27 & 0.42 & 2.28 & 2.28 & 0.21 & 0.25 & 0.25 & 2.23 & 0.75 & 0.75  \\
    $\gamma_{02}$ & 2.80 & 6.10 & 2.03 & 0.24 & 1.78 & 0.20 & 0.63 & 6.34 & 0.79 & 1.40 & 14.13 & 1.40 & 0.75 & 8.05 & 1.19 \\
    $\gamma_{12}$ & 1.12 & 2.28 & 0.88 & 0.22 & 0.66 & 0.20 & 0.24 & 1.15 & 0.41 & 0.28 & 2.27 & 0.32 & 1.22 & 1.74 & 1.04  \\
    \bottomrule
  \end{tabular}

\end{table}


\begin{table}[h]
  \renewcommand{\arraystretch}{1.3}
  \centering
  \caption{Scenario 3: MSE for coefficients estimates of quantiles
    0.1, 0.3, 0.5, 0.7, 0.9 under MNAR scenario. In this scenario, we used the correct
    sensitivity parameters
    for our approach. $(\gamma_{01}, \gamma_{11})$
    are quantile regression coefficients for $Y_{i1}$, and $(\gamma_{02}, \gamma_{12})$
    are ones for $Y_{i2}$. MM stands for our proposed method, and RQ stands for the 'rq'
    function in R package 'quantreg'.} \label{tab:sim3}
  \vspace{10pt}
  \tabcolsep = 0.11cm
  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR Normal} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 0.03 & 0.05 & 0.05 & 0.04 & 0.07 & 0.07 & 0.08 & 0.59 & 0.59 & 0.03 & 0.07 & 0.07 & 0.04 & 0.06 & 0.06\\
    $\gamma_{11}$ & 0.04 & 0.06 & 0.06 & 0.03 & 0.08 & 0.08 & 0.11 & 0.71 & 0.71 & 0.03 & 0.08 & 0.08 & 0.04 & 0.06 & 0.06\\
    $\gamma_{02}$ & 0.04 & 0.32 & 0.07 & 0.04 & 0.77 & 0.08 & 0.05 & 2.31 & 0.32 & 0.09 & 4.66 & 0.85 & 0.13 & 6.44 & 1.11\\
    $\gamma_{12}$ & 0.04 & 0.14 & 0.08 & 0.03 & 0.21 & 0.06 & 0.04 & 0.30 & 0.08 & 0.05 & 0.44 & 0.08 & 0.07 & 0.67 & 0.10\\
    \bottomrule
  \end{tabular}
  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR $T_3$} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 0.20 & 0.10 & 0.10 & 0.13 & 0.09 & 0.09 & 0.17 & 0.50 & 0.50 & 0.11 & 0.09 & 0.09 & 0.18 & 0.11 & 0.11 \\
    $\gamma_{11}$ & 0.26 & 0.11 & 0.11 & 0.08 & 0.10 & 0.10 & 0.17 & 0.55 & 0.55 & 0.07 & 0.09 & 0.09 & 0.30 & 0.11 & 0.11 \\
    $\gamma_{02}$ & 0.43 & 0.58 & 0.14 & 0.11 & 0.67 & 0.09 & 0.16 & 2.32 & 0.41 & 0.31 & 5.05 & 0.96 & 0.71 & 6.02 & 1.01 \\
    $\gamma_{12}$ & 0.24 & 0.28 & 0.13 & 0.08 & 0.17 & 0.06 & 0.10 & 0.30 & 0.10 & 0.16 & 0.50 & 0.10 & 0.35 & 0.76 & 0.20 \\
    \bottomrule
  \end{tabular}

  \begin{tabular}{rrrrrrrrrrrrrrrr}
    \toprule
    & \multicolumn{15}{c}{MNAR Laplace \footnote{}} \\
    \cline{2-16}
    &  \multicolumn{3}{c}{0.1} &  \multicolumn{3}{c}{0.3} &  \multicolumn{3}{c}{0.5} &
    \multicolumn{3}{c}{0.7} &  \multicolumn{3}{c}{0.9} \\
    \cline{2-16}
    & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   & MM   & RQ   & BZ   \\
    \hline
    $\gamma_{01}$ & 1.25 & 1.40 & 1.40 & 0.86 & 0.27 & 0.27 & 0.47 & 2.10 & 2.10 & 0.89 & 0.27 & 0.27 & 1.02 & 1.40 & 1.40  \\
    $\gamma_{11}$ & 1.69 & 0.66 & 0.66 & 0.21 & 0.26 & 0.26 & 0.44 & 2.30 & 2.30 & 0.22 & 0.28 & 0.28 & 2.18 & 0.69 & 0.69  \\
    $\gamma_{02}$ & 2.61 & 6.31 & 1.89 & 0.21 & 1.81 & 0.18 & 0.30 & 6.38 & 0.78 & 0.52 & 14.35 & 1.36 & 1.63 & 8.03 & 1.05 \\
    $\gamma_{12}$ & 1.07 & 2.19 & 0.79 & 0.19 & 0.57 & 0.18 & 0.24 & 1.12 & 0.40 & 0.29 & 2.15 & 0.33 & 1.18 & 1.77 & 1.05  \\
    \bottomrule
  \end{tabular}

\end{table}

\section{Real Data Analysis}
\label{sec:real}
We apply our quantile regression approach to data from TOURS, a weight
management clinical trial \citep{perri2008extended}.  This trial was
designed to test whether a lifestyle modification program could
effectively help people to manage their weights in the long
term. After finishing the six-month program, participants were
randomly assigned to three treatments groups: face-to-face counseling,
telephone counseling and control group. Their weights were recorded at
baseline ($Y_0$), 6 months ($Y_1$) and 18 months ($Y_2$) after the
trial. Here, we are interested in how the distribution of weights at
six months and eighteenth months change with covariates. The
regressors of interest include AGE (50-75), RACE (black and white) and
weights at baseline ($Y_0$). Weights at the six months ($Y_1$) were
always observed and 13 out of 224 observations (6\%) were missing at
18 months ($Y_2$). All weights were scaled by 1/100 for computation
stability.

We fitted regression models for bivariate responses $\bm Y_i =
(Y_{i1}, Y_{i2})$ for quantiles (5\%, 30\%, 50\%, 70\%, 95\%).  We ran
1,000 bootstrap samples to obtain 95\% confidence intervals.

Estimates under MAR are presented in Table \ref{tab:w2}. For weights
of participants at six months, weights of whites are generally lower
than those of blacks, because for all quantiles, the coefficients of
race are negative. For the extreme quantiles (5\% and 95\%), the
difference is small and not significant. However, when comparing the
weights for quantiles 30\%, 50\% and 70\%, whites tend to weigh
significantly less than blacks. The differences are 8kg, 7kg, and 8kg
separately. Meanwhile, weights of participants show obvious
heterogeneity by age. Participants tend to weigh less when older. The
trend is for all quantiles, but the effect is again small and not
significant.

\begin{table}[ht]
  \renewcommand{\arraystretch}{1.3}
  \begin{center}
    \caption{Estimated marginal quantile regression coefficients with
      95\% bootstrap percentile confidence interval for weight of
      participants at 6 and 18 months. Weight measurement is scaled by
      1/100. Missing data mechanism assumption is MAR.}\label{tab:w2}
    \vspace{10pt} \tabcolsep = 0.11cm
    \begin{tabular}{rrrrr}
      \toprule
           & Intercept           & Age.centered.        & White                & BaseWeight        \\
      \hline
      Weight at 6 months                                                                           \\
      5\%  & -0.02 (-0.09, 0.04) & 0.01 (-0.02, 0.02)   & -0.07 (-0.08, 0.01)  & 0.85 (0.80, 0.90) \\
      30\% & 0.01 (-0.03, 0.04 ) & 0.00 (-0.00, 0.01)   & -0.04 (-0.06, -0.03) & 0.90 (0.86, 0.93) \\
      50\% & 0.01 (-0.03, 0.04 ) & 0.00 (-0.00, 0.01)   & -0.04 (-0.05, -0.02) & 0.92 (0.88, 0.96) \\
      70\% & 0.01 (-0.04, 0.05 ) & 0.00 (-0.00, 0.01)   & -0.04 (-0.05, -0.02) & 0.95 (0.90, 0.99) \\
      95\% & 0.02 (-0.01, 0.06 ) & -0.01 (-0.03, 0.06)  & 0.06 (-0.05, 0.04)   & 1.06 (0.96, 1.06) \\
      Weight at 18 months                                                                          \\
      5\%  & 0.06 (0.03, 0.12 )  & 0.01 (-0.03, 0.01)   & -0.08 (-0.10, -0.03) & 0.73 (0.68, 0.81) \\
      30\% & 0.05 (0.02, 0.09 )  & -0.00 (-0.01, 0.01)  & -0.04 (-0.06, -0.02) & 0.86 (0.82, 0.89) \\
      50\% & 0.05 (-0.01, 0.08 ) & -0.00 (-0.01, 0.01)  & -0.04 (-0.06, -0.02) & 0.90 (0.85, 0.97) \\
      70\% & 0.04 (-0.01, 0.07 ) & -0.00  (-0.01, 0.01) & -0.03 (-0.05, -0.01) & 0.94 (0.91, 0.99) \\
      95\% & 0.10 (0.00, 0.12 )  & -0.01  (-0.03, 0.06) & 0.06 (-0.03, 0.06)   & 1.03 (0.99, 1.07) \\
      \bottomrule
    \end{tabular}
  \end{center}
\end{table}

For weights at 18 months after baseline, we have similar
conclusions. Whites still weigh less than blacks for all quantiles,
but the magnitude is smaller than that at 6th months.  The differences
are 6kg, 6kg and 6kg instead of 8kg, 7kg and 8kg for quantiles 30\%,
50\% and 70\%. There is still a decreasing trend of weight with
increasing age.  However, none of these parameters are significant.

We also did a sensitivity analysis based on missing not at random
assumption. Based on previous studies of pattern of weight regain
after lifestyle treatment \citep{wadden2001, perri2008extended}, we
have the information that
\begin{displaymath}
  E(Y_2 - Y_1| R=0) = 3.6 \text{kg},
\end{displaymath}
which means 0.3kg regain per month after finishing the initial 6-month
program.  Therefore, we have sensitivity parameters in distribution of
$Y_2|Y_1, R=0$ in a restriction as:
\begin{displaymath}
  \Delta_{i2} + \bm x_{i2}^T \bm h_2^{(1)} + E(y_{i1}|R=0)(\beta_{y,1}^{(1)} +\eta_1^{(1)} - 1) = 3.6 \text{kg}.
\end{displaymath}

\begin{table}
  \renewcommand{\arraystretch}{1.3}
  \begin{center}
    \caption{Estimated marginal quantile regression coefficients with
      95\% confidence interval for weight of participants at 6 and 18
      months under MNAR assumption. Weight measurement is scaled by
      1/100.}\label{tab:toursmnar}
    \vspace{10pt} \tabcolsep = 0.11cm
    \begin{tabular}{rrrrr}
      \toprule
      & Intercept          & Age(centered)       & White                & BaseWeight        \\
      \hline
      Weight at 6 months                                                                         \\
      5\%  & 0.01 (-0.10, 0.05) & 0.00 (-0.01, 0.01)  & -0.04 (-0.07, -0.01) & 0.84 (0.78, 0.90) \\
      30\% & 0.00 (-0.07, 0.06) & 0.00 (-0.01, 0.01)  & -0.04 (-0.06, 0.07)  & 0.91 (0.82, 0.94) \\
      50\% & 0.01 (-0.03, 0.05) & 0.00 (-0.00, 0.01)  & -0.04 (-0.05, -0.02) & 0.92 (0.87, 0.96) \\
      70\% & 0.02 (-0.02, 0.06) & 0.00 (-0.00, 0.01)  & -0.04 (-0.06, 0.00)  & 0.93 (0.88, 0.97) \\
      95\% & 0.03 (-0.01, 0.07) & 0.00 (-0.00, 0.02)  & -0.02 (-0.05, 0.00)  & 0.96 (0.93, 1.01) \\
      Weight at 18 months                                                                        \\
      5\%  & 0.11 (-0.07, 0.15) & -0.00 (-0.02, 0.02) & -0.07 (-0.10, 0.01)  & 0.72 (0.67, 0.88) \\
      30\% & 0.05 (-0.04, 0.12) & -0.00 (-0.01, 0.01) & -0.05 (-0.07, 0.08)  & 0.86 (0.75, 0.92) \\
      50\% & 0.05 (0.01, 0.11)  & -0.00 (-0.01, 0.01) & -0.03 (-0.06, -0.02) & 0.90 (0.83, 0.95) \\
      70\% & 0.04 (-0.01, 0.10) & 0.00 (-0.01, 0.01)  & -0.03 (-0.06, 0.02)  & 0.94 (0.87, 0.98) \\
      95\% & 0.04 (-0.01, 0.12) & -0.00 (-0.01, 0.01) & -0.01 (-0.04, 0.02)  & 1.03 (0.95, 1.08) \\
      \bottomrule
    \end{tabular}
  \end{center}
\end{table}

Table \ref{tab:toursmnar} presents the estimates and bootstrap
percentile confidence intervals under the above MNAR mechanism. There
is no big difference for estimates of $Y_1, Y_2$ due to the missing
data mechanism assumption change for most of middle
quantiles. However, estimates for extreme quantiles behaved more
sensitive than those for middle quantiles.  For example, intercept for
$Y_2$ for 5\% quantile regression changed from 0.06 to 0.11.  The
intercept for $Y_2$ for 95\% quantile regression decreased from 0.10
to 0.04.  Despite this, the significance of coefficients of covariates
were unchanged. Significant covariates still remained statistical
significant.

\section{Discussion}
\label{sec:discussion}

In this paper, we have developed a marginal quantile regression model
for data with monotone missingness. We use a pattern mixture model to
jointly model the full data response and missingness. Here marginal
quantile regression coefficients are of interest instead of
coefficients conditional on random effects as in \citet{yuan2010}. In
addition, our approach allows non-parallel quantile lines over
different quantiles via the mixture distribution and heterogeneity of
variance and allows for sensitivity analysis which is essential for
the analysis of missing data \citep{nas2010}.

Our method allows the missingness to be MNAR.  We illustrated how to
put informative priors for Bayesian inference and how to find
sensitivity parameters to allow different missing data mechanisms.
The recursive integration algorithm simplifies computation and can be
easily implemented even in high dimensions.  Simulation studies
demonstrates that our approach has smaller MSE than the traditional
frequentist method \textit{rq} function for most cases, especially for
inferences of partial missing responses. And it has advantages over
Bottai's appraoch for middle quantiles regression inference when error
is heavy tailed. We also demonstrated sensitivity analysis and how to
allow non-ignorable missingness assumptions.

Our model assumes a multivariate normal distribution for each
component in the pattern mixture model, which might be too
restrictive. Previous simulation results showed that the
mis-specification on the error term did have impact on the extreme
quantile regression inferences.  It is possible to replace that with a
semi-parametric model, for example, the Dirichlet process mixture or
\polya{} tree.  Meanwhile, even though we use the multivariate normal
distributions within patterns, which can easily model MNAR departure
from MAR by difference in means and (co)-variances, we still need
strong assumptions for sequential multivariate normal distribution
within each pattern. Otherwise MAR constraints do not exist
\citep{wang2011}.  It would also be interesting to allow mixture
probabilities to depend on covariates.

\section{Acknowledgments}

\bibliographystyle{plainnat}
\bibliography{qr-missing-reference}

\appendix
\section{Identifiability}
\label{sec:iden}
First suppose $y$ is univariate and there are two patterns $R = 1$ and
$R = 0$.

Before going forward to quantile regression, first we consider
identifiability problem in mean regression.

Consider a pattern mixture model:
\begin{align}
  Y | R = 1 & \sim N(\Delta + \mu_1, \sigma_1), \label{eq:app1} \\
  Y | R = 0 & \sim N(\Delta + \mu_0, \sigma_0), \nonumber\\
  \prob (R = 1) & = \pi, \nonumber\\
  E (y ) & = \theta. \nonumber
\end{align}
Thus by iterated expectation, we have
\begin{align*}
  \theta = \Delta + \mu_1\pi + \mu_0(1-\pi), \\
  \Delta = \theta - \pi \mu_1 - (1 - \pi)\mu_0.
\end{align*}
We can see $\Delta$ is determined by $\theta, \mu_1, \mu_0$. Plugging
in (\ref{eq:app1}), we have
\begin{align*}
  Y| R = 1 & \sim N(\theta + (1 - \pi)\mu_1 - (1 - \pi)\mu_0, \sigma_1), \\
  Y| R = 0 & \sim N(\theta - \pi \mu_1 + \pi \mu_0, \sigma_0).
\end{align*}
Denote $\xi_1 = (\theta, \mu_1, \mu_0)$, and if $\xi_2 = (\theta,
\mu_1+ c, \mu_0+c)$, both groups of parameters lead to the same
distribution of $\pr(y, R) = \pr(y|R)\pr(R)$. Therefore, $\xi$ is not
identifiable.  If we put constraints on $\mu_1$ and $\mu_0$, for
example $\mu_0 = 0$, then
\begin{align*}
  Y | R = 1 & \sim N(\theta + \mu_1, \sigma_1), \\
  Y | R = 0 & \sim N(\theta, \sigma_0).
\end{align*}
Thus $\bm \xi = (\theta, \mu_1)$ is identifiable. If $\xi_2 \neq
\xi_1$, then $\pr_2(y, R) \neq \pr_1(y, R)$.

Secondly, we consider quantile regression for a pattern mixture model:
\begin{align*}
  Y | R = 1 & \sim N(\Delta + \mu_1, \sigma_1),\\
  Y | R = 0 & \sim N(\Delta + \mu_0, \sigma_0),\\
  \prob (R = 1) & = \pi,\\
  \pr (Y \leq \theta ) & = \tau,
\end{align*}
where $\theta$ is the quantile estimate of interest. We again show
$\bm \xi = (\theta, \mu_1, \mu_0) $ is not identifiable.

Again by iterated expectations, we have
\begin{align*}
  \tau = \pi \Phi \left( \frac{\theta - \Delta - \mu_1}{\sigma_1}
  \right) + (1 - \pi) \Phi \left( \frac{\theta - \Delta -
      \mu_0}{\sigma_0} \right).
\end{align*}
Thus $\Delta$ is again determined by the other parameters:
\begin{align*}
  \Delta = h(\theta, \mu_1, \mu_0, \sigma_1, \sigma_0, \pi, \tau).
\end{align*}
To show $\bm \xi = (\theta, \mu_1, \mu_0, \sigma_1, \sigma_0)$ is not
identifiable, we need to find $\bm \xi^{'} \neq \bm \xi$, such that
$\pr(y|R) = \pr^{'}(y|R)$. If the last equation holds, then we must
have $\sigma_1^{'} = \sigma_1, \sigma_0^{'} = \sigma_0$, thus we still
need to find $\theta^{'}, \mu_1^{'}, \mu_0^{'}$ such that
\begin{align*}
  h(\bm \xi) + \mu_1 & = h(\bm \xi^{'}) + \mu_1^{'},\\
  h(\bm \xi) + \mu_0 & = h(\bm \xi^{'}) + \mu_0^{'}.
\end{align*}
By substracting previous equations, we have $\mu_1^{'}- \mu_0^{'} =
\mu_1- \mu_0$. Denote $\mu_1^{'} = \mu_1 + \delta$ and $\mu_0^{'} =
\mu_0 + \delta$, and let $\theta^{'} = \theta$ such that
\begin{align*}
  \Delta^{'} = h(\theta^{'}, \mu_1, \mu_0, \sigma_1, \sigma_0, \delta)
  = h(\bm \xi) - \delta = \Delta - \delta.
\end{align*}
Then the new parameter $\bm \xi^{'}$ yields the same distribution as
$\bm \xi$. Therefore $\bm \xi$ is not identifiable.

If we use a constraint, for example $\mu_1 = -\mu_0$, then
$\pr(y|R;\bm \xi) = \pr(y|R; \bm \xi^{'})$ yields $\bm \xi = \bm
\xi^{'}$.

Now consider the situation with covariates. Suppose the model is
\begin{align*}
  Y | R = 1, x & \sim N(\Delta + \mu_1 + \beta_{x1} x, \sigma_1),\\
  Y | R = 0, x & \sim N(\Delta - \mu_1 + \beta_{x0} x, \sigma_0),\\
  \prob (R = 1) & = \pi,\\
  \pr (Y \leq \gamma_0 + \gamma_1 x ) & = \tau.
\end{align*}
$\Delta$ can still be determined by
\begin{align*}
  \Delta = h(x, \gamma_0, \gamma_1, \mu_1, \beta_{x1}, \beta_{x0},
  \sigma_1, \sigma_0, \pi, \tau).
\end{align*}
We want to show the parameter $\bm \xi = (\gamma_0, \gamma_1, \mu_1,
\beta_{x1}, \beta_{x0}, \sigma_1, \sigma_0, \pi )$ is not identifiable
by finding $\bm \xi^{'} \neq \bm \xi$, but $\pr (y | R; \bm \xi) = \pr
(y | R; \bm \xi^{'})$. If the last equation holds, we have
$\sigma_1^{'} = \sigma_1, \sigma_0^{'} = \sigma_0$, and to equate the
two means, we have
\begin{align*}
  \Delta + \mu_1 + \beta_{x1} x & = \Delta^{'} + \mu_1^{'} + \beta_{x1}^{'}x,\\
  \Delta - \mu_1 + \beta_{x0} x & = \Delta^{'} - \mu_1^{'} +
  \beta_{x0}^{'}x.
\end{align*}
By substracting the two equations, we have
\begin{align*}
  2\mu_1 + (\beta_{x1} - \beta_{x0}) x = 2\mu_1^{'} + (\beta_{x1}^{'}
  - \beta_{x0}^{'}) x,
\end{align*}
which holds for all $x$. Thus $\mu_1 = \mu_1^{'}$ and $(\beta_{x1} -
\beta_{x0}) = (\beta_{x1}^{'} - \beta_{x0}^{'})$. Then let
\begin{align*}
  \beta_{x1}^{'} =  \beta_{x1} + \delta, \\
  \beta_{x0}^{'} = \beta_{x0} + \delta,
\end{align*}
and keep all the other parameters in $\bm \xi^{'}$ the same. We can
still have the same distribution of $y|R; \bm \xi$ but with different
$\bm \xi$. Therefore, $\bm \xi$ is not identifiable One solution is to
restrict $\beta_{x1} = - \beta_{x0}$ or $\beta_{x1} = 0$.

Now consider the bivariate $(y_1, y_2)$ case, and we focus on the
identifiability issue especially $y_2|y_1$. Suppose the model is
\begin{align*}
  Y_2 | y_1, x, R = 1 \sim N(\Delta + \mu_1 + x\beta_{x1} + \beta_{11}y_1, \sigma_1), \\
  Y_2 | y_1, x, R = 0 \sim N(\Delta - \mu_1 - x\beta_{x1} +
  \beta_{10}y_1, \sigma_0).
\end{align*}
Here $R$ stands for two different patterns, and missingness is not
considered.

Regarding the identifiability of $\beta_{11}$ and $\beta_{10}$,
assume there exists $\beta_{11}^{'}$ and $\beta_{10}^{'}$, such that
\begin{align*}
  \Delta + \mu_1 + x\beta_x + \beta_{11}y_1 = \Delta^{'} + \mu_1^{'} + x\beta_{x}^{'} + \beta_{11}^{'}y_1, \\
  \Delta - \mu_1 - x\beta_x + \beta_{10}y_1 = \Delta^{'} - \mu_1^{'} -
  x\beta_{x}^{'} + \beta_{10}^{'}y_1.
\end{align*}
By substracting two equations, we have $\mu_1 = \mu_1^{'}$ and
$\beta_x = \beta_x^{'}$. Since $\Delta$ is determined by integrating
out $y_1$, such that matching the two sides of the above equation for
coefficient of $y_1$, we must have $\beta_{11} = \beta_{11}^{'}$ and
$\beta_{10} = \beta_{10}^{'}$, therefore, $\bm \xi$ is identifiable.

For identifiability issue with the heterogeneous model described in
section \ref{sec:settings}, it is easy to show there is no trouble
with the heterogeneity parameters $\alpha$, analogous to the linear
model case. For the other parameters, it can be found similar to the
above development.

\section{Proof of Lemma \ref{sec:lemma}}
\label{sec:proof}
\begin{itemize}
\item Denote
  \begin{displaymath}
    I(a,b) = \int \Phi \left( \frac{x-b}{a} \right)\phi(x) dx,
  \end{displaymath}
  where $\Phi$ is the standard normal cdf and $\phi$ is the standard
  normal pdf and $a > 0$.
  \begin{align*}
    \frac{\partial I(a,b)}{\partial b} & = - \frac{1}{a} \int \phi \left( \frac{x-b}{a} \right) \phi(x) dx \\
    & = - \frac{1}{\sqrt{2 \pi} \sqrt{a^2+1}} \exp \left( - \frac{b^2}{2(a^2+1)} \right)\\
    & = -\frac{1}{\sqrt{a^2+1}} \phi \left( \frac{b}{\sqrt{a^2+1}}
    \right).
  \end{align*}
  Since $I(a, \infty) = 0$,
  \begin{align}
    I(a,b) &= - \frac{1}{\sqrt{a^2+1}} \int_b^{\infty} \phi \left( \frac{s}{\sqrt{a^2+1}} \right) ds \nonumber \\
    &= \int_{b/\sqrt{a^2+1}}^{\infty} \phi(t) dt \nonumber\\
    \label{eq:int}
    & = 1- \Phi(b/\sqrt{a^2+1}).
  \end{align}
  For $a < 0$,
  \begin{align*}
    \frac{\partial I(a,b)}{\partial b} & = - \frac{1}{a} \int \phi \left( \frac{x-b}{a} \right) \phi(x) dx \\
    & = - \frac{sgn(a)}{\sqrt{2 \pi} \sqrt{a^2+1}} \exp \left( - \frac{b^2}{2(a^2+1)} \right)\\
    & = -\frac{sgn(a)}{\sqrt{a^2+1}} \phi \left(
      \frac{b}{\sqrt{a^2+1}} \right).
  \end{align*}
  Since $I(a, -\infty) = 0$:
  \begin{align}
    I(a,b) &= \int^{b/\sqrt{a^2+1}}_{-\infty} \phi(t) dt \nonumber\\
    \label{eq:intneg}
    & = \Phi(b/\sqrt{a^2+1}).
  \end{align}
\item For integrating over a normal distribution with mean $\mu$ and
  standard deviation $\sigma$:
  \begin{align*}
    \int \Phi(x)d\Phi(x; \mu, \sigma) & = \int \Phi(x) \frac{1}{\sigma} \phi \left( \frac{x-\mu}{\sigma} \right) dx \\
    & = \int \Phi(\sigma t + \mu)\phi(t) dt \\
    & = 1 - \Phi(-\mu/\sigma/\sqrt{1/\sigma^2+1}).
  \end{align*}
  The last equation holds by (\ref{eq:int})
\item For integrating a $\textrm{N}(b, a)$ CDF over another normal
  distribution ($\textrm{N}(\mu, \sigma$)):
  \begin{align}
    \int \Phi \left( \frac{x-b}{a} \right) d\Phi(x; \mu, \sigma) & = \int \Phi \left( \frac{x-b}{a} \right) \frac{1}{\sigma} \phi \left( \frac{x-\mu}{\sigma} \right) dx \nonumber\\
    &= \int \Phi \left( \frac{\sigma y + \mu - b}{a}  \right) \phi(y) dy \nonumber \\
    \label{eq:intg1}
    & = 1- \Phi \left( \frac{b-\mu}{\sigma} /
      \sqrt{\frac{a^2}{\sigma^2}+1} \right).
  \end{align}
  If $a < 0$,
  \begin{equation}
    \label{eq:intg2}
    \int \Phi \left( \frac{x-b}{a} \right) d\Phi(x; \mu, \sigma) = \Phi \left( \frac{b-\mu}{\sigma} / \sqrt{\frac{a^2}{\sigma^2}+1} \right).
  \end{equation}

\end{itemize}

\section{Maximum Likelihood Estimation Using Adaptive Gradient Descent
  Algorithm}
\label{sec:agda}

See section \ref{sec:mle} for notation.

The likelihood can be maximized via the following algorithm:
\begin{enumerate}
\item initialize $\bm \xi$
\item \label{item:der} calculate $\partial J(\bm \xi) / \partial
  \xi_j$ for all $j$,
\item update $\bm \xi$ by adaptive gradient descent algorithm
  described in \citep{ried1993} for all $j$
\item evaluate new $J(\bm \xi)$
\item if the amount of descent of $J ( \bm \xi)$ is greater than a
  certain cutoff, then go back to step \ref{item:der} and
  repeat. Otherwise, algorithm converges.
\end{enumerate}

We can use numerical approximation to calculate $\partial J(\bm
\xi)/\partial \xi_j$ in step \ref{item:der}. For example, for $j = 1$,
\begin{displaymath}
  \frac{\partial J(\bm \xi)}{\partial \xi_1} \approx \frac{J(\xi_1 + \epsilon, \xi_2, \ldots) - J(\xi_1 - \epsilon, \xi_2, \ldots)}{2\epsilon}.
\end{displaymath}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
